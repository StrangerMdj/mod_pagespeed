<div id=footer>
  <!--#include virtual="_navline.html" -->
</div>

<script>
function buildTocHelper(node, headers) {
  if (node.nodeType == 1) {
    // Element node.
    var nodeName = node.nodeName.toLowerCase();
    if (nodeName == "h2" || nodeName == "h3" || nodeName == "h4" ||
        nodeName == "h5" || nodeName == "h6") {
      if (node.id) {
        headers.push([nodeName, node.innerHTML, node.id]);
        node.innerHTML +=
          '&nbsp;<a class=header-link href="#' + node.id + '">&#x1f517;</a>';
      }
    } else {
      for (var i = 0; i < node.childNodes.length; i++) {
        buildTocHelper(node.childNodes[i], headers);
      }
    }
  }
}

function buildToc() {
  var headers = [];
  buildTocHelper(document.body, headers);
  if (headers.length == 0) {
    return;
  }

  var toc = "<div id=toc-contents>Contents</div>";
  var level = 1;
  for (var i = 0; i < headers.length; i++) {
    var header = headers[i];
    var headerLevel = header[0];
    var headerValue = header[1];
    var headerId = header[2];

    var newLevel = parseInt(headerLevel.substring(1));
    while (newLevel > level) {
      toc += "<ul>"
      level++;
    }
    while (newLevel < level) {
      toc += "</ul>";
      level--;
    }
    toc += '<li><a href="#' + headerId + '">' + headerValue + '</a>'
  }
  while (level > 1) {
    toc += "</ul>";
    level--;
  }
  document.getElementById("toc").innerHTML += toc;
}

function wrapTables() {
  var tables = document.getElementsByTagName("table");
  for (var i = 0; i < tables.length; i++) {
    var table = tables[i];
    var parent = table.parentNode;
    var div = document.createElement('div');
    div.className = "table-wrapper";
    parent.insertBefore(div, table);
    div.appendChild(table);
  }
}

buildToc();
wrapTables();
</script>
