<div id=footer>
  <!--#include virtual="_navline.html" -->
</div>

<script>
function build_toc_helper(node, headers) {
  if (node.nodeType == 1) {
    // Element node.
    var node_name = node.nodeName.toLowerCase();
    if (node_name == "h2" || node_name == "h3" || node_name == "h4" ||
        node_name == "h5" || node_name == "h6") {
      if (node.id) {
        headers.push([node_name, node.innerHTML, node.id]);
        node.innerHTML +=
          '&nbsp;<a class=header-link href="#' + node.id + '">&#x1f517;</a>';
      }
    } else {
      for (var i = 0; i < node.childNodes.length; i++) {
        build_toc_helper(node.childNodes[i], headers);
      }
    }
  }
}

function build_toc() {
  var headers = [];
  build_toc_helper(document.body, headers);
  if (headers.length == 0) {
    return;
  }

  var toc = "<div id=toc-contents>Contents</div>";
  var level = 1;
  for (var i = 0; i < headers.length; i++) {
    var header = headers[i];
    var header_level = header[0];
    var header_value = header[1];
    var header_id = header[2];

    var new_level = parseInt(header_level.substring(1));
    while (new_level > level) {
      toc += "<ul>"
      level++;
    }
    while (new_level < level) {
      toc += "</ul>";
      level--;
    }
    toc += '<li><a href="#' + header_id + '">' + header_value + '</a>'
  }
  while (level > 1) {
    toc += "</ul>";
    level--;
  }
  document.getElementById("toc").innerHTML += toc;
}

function wrap_tables() {
  var tables = document.getElementsByTagName("table");
  for (var i = 0; i < tables.length; i++) {
    var table = tables[i];
    var parent = table.parentNode;
    var div = document.createElement('div');
    div.className = "table-wrapper";
    parent.insertBefore(div, table);
    div.appendChild(table);
  }
}

build_toc();
wrap_tables();
</script>
